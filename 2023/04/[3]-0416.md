# ARC

Swift는 ARC를 사용해서 앱 내 메모리를 자동으로 관리합니다.

→ 개발자가 메모리 관리에 대해서 고민할 필요가 없게 해줍니다. 하지만 몇몇의 경우 ARC에서 메모리 관리를 위해 코드의 특정 부분에 대한 관계에 대한 정보를 필요로 합니다.

RC는 클래스에서만 적용되고, Struct(구조체), Enum(열거형)은 값 타입이므로 참조 타입이 아니기 떄문에 RC의 영향을 받지 않습니다.

### 동작원리

클래스의 새로운 인스턴스를 만들 때 ARC는 인스턴스의 정보를 저장하기 위해 메모리를 할당하고 그리고 인스턴스가 더 이상 사용하지 않는다고 판단된다면 메모리를 해제 한다.

만약 ARC가 사용중인 클래스 인스턴스 메모리를 해제하게 된다면, 해당 인스턴스 프로퍼티들에 더 이상 접근하지 못하거나, 인스턴스의 메서드를 호출하지 못할 수 있다.

필요한 인스턴스들이 사라지지 않도록 하는 것을 보장하기 위해 ARC는 현재 각각의 인스턴들에 대해 얼마나 많은 프로퍼티, 상수, 변수들이 참조하고 있는지를 추적하고 인스턴스들이 여전히 존재할 수 있도록 최소한 한 개의 활성 참조가 있는 한 인스턴스를 해제하지 않는다.

### 클래스 간 인스턴스 간 강한 참조 순환

ARC에서 기본적으로 참조 횟수에 대해 추적하고 있기 때문에 사용하지 않는 인스턴스는 자동으로 메모리에서 해제되게 됩니다. 하지만 메모리에서 해제 되지 않는 경우가 있는데, 클래스의 인스턴스간 강한참조순환을 하고 있는 경우 입니다. 그럴 경우 메모리 누수가 발생하기 때문에 해결책이 필요 합니다.

## 클래스 인스턴스 간 강한 참조 순환 문제 해결

강한 참조 순환 문제를 해결하기 위해선 두 가지 방법이 있는데, 하나는 weak 참조, unowned 참조가 있습니다. weak, unowned 참조 모두 ARC에서 참조 횟수를 증가시키지 않고 인스턴스를 참조 합니다.

약한 참조는 참조하고 있는 인스턴스가 먼저 메모리에서 해제될 때 사용하고 미소유 참조는 반대로 참조하고 있는 인스턴스가 같은 시점 혹은 더 뒤에 해제될 때 사용 합니다.