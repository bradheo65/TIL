# 싱글톤 패턴(Singleton Pattern)이란 무엇이며, 어떤 경우에 사용하나요?

> 하나의 유일한 객체를 만들기 위한 코드 패턴입니다.

좀더 자세히 얘기하면, 메모리 절약을 위해, 객체가 필요할 떄 새로 만들지 않고, 기존 메모리에 올려져 있는 객체를 활용하는 기법입니다.
비슷한 역활을 하는 "전역 변수"도 있는데, 이 개념을 그대로 클래스에 대입한 것이 싱글턴 패턴입니다.

> 사용하는 경우
> 1. 객체 초기화 시 리소스를 많이 차지하는 것일 수록 사용하면 좋습니다. 최초 초기화 후, 그 이후엔 메모리상에 있는 객체를 사용하기 떄문에, 조금이나마 빠르게 접근이 가능해집니다. 
> 2. 어디서든 접근이 가능하기 떄문에, 상태를 표시하거나, 데이터를 공유할떄 사용하면 좋습니다. 다만 데이터 접근 시 동시성을 고려해야 합니다.

iOS에서는 대표적으로 아래와 같은 곳에서 사용하고 있습니다.

```swift
UIScreen.main
UserDefaults.standard
UIApplication.shared
FileManager.default
NotificationCenter.default
```

# Swift에서 싱글톤 패턴을 구현할 때 멀티스레드에 대해서 어떻게 고려해야 하나요?

> `static` 키워드와 `private init`을 통해 여러 객체에서 초기화되는 것을 제한합니다. 

Swift에서는 `static` 키워드로 타입 프로퍼티로 인스터스를 생성하게 되면, 싱글턴 인스턴스가 여러 스레드에서 동시에 접근해도 단 한번만 초기화되는 것을 보장합니다.

단 한번만 초기화되는 것을 보장하는 것은 Swift의 전역(Global) 및 타입 프로퍼티의 초기화 방식 떄문입니다.

1. `static` 프로퍼티는 lazy로 동작합니다.
    - Swift 프로퍼티 공식문서 중 "전역(global) 상수와 변수는 항상 lazy로 계산된다"라고 안내해주고 있습니다. `static`도 항상 전역(global)로 선언되기 떄문에 lazy로 계산되기에 접근시 초기화 되는 특성을 가지고 있습니다.

2. 타입 프로퍼티 초기화 시 멀티스레드 환경에서도 단 한번만 실행되도록 되어 있습니다.
    - Swift 컴파일러가 내부적으로 `dispatch_once`와 유사한 동작을 수행합니다.

추가로 초기화 시 `private`키워드를 사용하는 이유는 외부에서 새로운 인스턴스를 만들지 못하도록 강제하기 위해서 입니다.
`static let`이 단 한번만 초기화를 보장한다고 하지만, 외부에서 새로운 인스턴스 생성하는 것을 막지 못하기 떄문입니다.